# RectPaint 問題仕様

## 問題文

80×80のグリッドがあり、各セルには `.`, `-`, `+` のいずれかの文字が書かれています。

初期状態では全てのセルが `.` です。

あなたは以下の操作を最大800回行うことができます：

**操作**: 2つの座標 `(r1, c1)` と `(r2, c2)` を指定し、その長方形領域を文字 `x` ∈ {`.`, `-`, `+`} で塗りつぶす

- 座標は0-indexedで、`0 ≤ r1, r2, c1, c2 < 80`
- 長方形は `[min(r1,r2), max(r1,r2)] × [min(c1,c2), max(c1,c2)]` の範囲
- 領域内の全セルが `x` で上書きされる

## 目標

与えられた目標盤面 `T` と、操作後の盤面 `A` を一致させることを目指します。

## 制約

- グリッドサイズ: 80 × 80（固定）
- 使用可能文字: `.`, `-`, `+`
- 最大操作回数: 800回
- 時間制限: ローカル実行のため特になし

## 入力形式

```
80 seed
T[0]
T[1]
...
T[79]
```

- 1行目: `80 seed` （`80`は盤面サイズ、`seed`はテストケースのシード値）
- 2-81行目: 各行80文字の盤面データ（`.`, `-`, `+` のみ）

## 出力形式

```
M
r1 c1 r2 c2 x
r1 c1 r2 c2 x
...
(M行)
```

- 1行目: 操作回数 `M`（`0 ≤ M ≤ 800`）
- 2行目以降: M個の操作
  - `r1 c1 r2 c2 x`: 座標(r1,c1)と(r2,c2)を結ぶ長方形を色xで塗る

## スコアリング

最終盤面 `A` と目標盤面 `T` の差分を計算します。

```
diff = (Aとt異なるセルの数)
score = 10000 × diff + M
```

**スコアが小さいほど良い**です。

- `diff = 0` の場合、完全一致で `score = M`（手数のみ）
- `diff > 0` の場合、不一致セル数が大きくスコアに影響

## 判定

`tools/judge/judge` が公式ジャッジです。

### 正常終了の出力

```
valid: 1
score: <score>
diff: <diff>
moves: <M>
```

### エラーの出力

```
valid: 0
score: 1000000000000000000
diff: -1
moves: <M or -1>
reason: <エラー理由>
```

エラー条件:
- `M < 0` または `M > 800`
- 操作が `M` 行読めない
- 座標が範囲外（`0 ≤ r, c < 80`）
- 色が `.`, `-`, `+` 以外

## 難易度レベル（Tier）

generatorは難易度レベルを指定できます:

```bash
./tools/gen/gen <seed> <tier>
```

- **Tier 0 (easy)**: 初心者向け、diff=0が達成しやすい
- **Tier 1 (normal)**: 標準難易度、工夫が必要
- **Tier 2 (hard)**: 難しい、上級者向け
- **Tier 3 (insane)**: 超難関、完全一致はほぼ不可能(作成者はできませんでした)

## 公式シード

- `seeds/tier0_easy.txt`: seeds 0-99
- `seeds/tier1_normal.txt`: seeds 100-199（メイン）
- `seeds/tier2_hard.txt`: seeds 200-299
- `seeds/tier3_insane.txt`: seeds 300-399

## サンプル

`examples/` フォルダにサンプル入出力があります。

## 可視化

`tools/vis/viewer.html` をブラウザで開いて、入力ファイルと出力ファイルを読み込むと、操作を1手ずつ再生できます。

## 注意事項

- **judgeの出力が唯一の公式スコア**です
- visualizerやtesterの表示はあくまで参考
- 出力形式が不正な場合、`valid: 0` となりスコアは最悪値

## アルゴリムのヒント

- 貪欲法: 毎回、最も改善する長方形を選ぶ
- 2D Kadane: 最大部分矩形を効率的に見つける
- レイヤー戦略: 基調色を最初に塗り、上から細部を重ねる
- 分割統治: 盤面を分割して再帰的に処理

頑張ってください！
